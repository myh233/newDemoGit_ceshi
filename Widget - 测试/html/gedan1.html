<!DOCTYPE html>
<html>
<head>
    <title>Module Develop</title>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312">
    <style type="text/css">
        html,body {
            width:100%;
            height: 100%;
        }

        body {
            width:100%;
            background-color: #fff;
            margin: 0;
        }

		    .aui-list-item-title{
      			font-size: 100%;
      			border:none;
      			background-color: white;
		    }

        .music_list {
            font-size: 100%;
            width:100%;
        }
       .aui-list-item-title{
         font-size: 100%;
         border:none;
         background-color: white;
      }
    </style>
</head>

<body>\
    <div class = 'music_list'>
      <ul id="aui-list aui-list-noborder">
        <!--<li class="aui-list-item">
          <div class="aui-list-item-inner">
            <input class="aui-list-item-title" id="5189652" onclick="selectMusic1()" type="button" value="Menuet D major --Wolfgang Amadeu">
          </div>
        </li>-->
      </ul>
    </div>
    <!--<div class = "music_list">
      歌单
		  <div>
          <input class="aui-list-item-title" id="865854699" onclick="selectMusic1()" type="button" value="朋友请听好(易烊千玺版) --易烊千玺">
		  </div>
		  <div>
          <input class="aui-list-item-title" id="1344038671" onclick="selectMusic2()" type="button" value="我们(live)  --华晨宇">
		  </div>
		  <div>
          <input class="aui-list-item-title" id="440073029" onclick="selectMusic3()" type="button" value="新世界(live)  --华晨宇">
		  </div>
		</div>-->
    <button onclick="search()">测试</button>

    <script type="text/javascript">
        //获取主页面搜索框传递来的数据
        var url = location.search;
        url = unescape(url);
        var name_or_singer = url.substring(url.lastIndexOf('=')+1, url.length);
        var demo;

        //根据歌名搜索
        function search(){
           var value = name_or_singer;
           var query = api.require('query');
           var model = api.require('model');
              model.config({
               appKey: '075A132B-2B11-505D-F01E-FA8B51604C1B',
               appId: 'A6036872544676',
               host: 'https://d.apicloud.com'
              });
              query.createQuery(function(ret,err){
            if(ret && ret.qid){
             //console.log(ret.qid)
             query.whereLike({
               qid:ret.qid,
               value:value,
               column:'name'
             });
             model.findAll({
              class: 'music',
              qid: ret.qid
             },function(ret,err){
               if(ret){
                  alert(JSON.stringify( ret ))
                  alert(ret.length);
                  //ret.length  搜索结果条数
                  var html="";
    				      for(var i=0;i<ret.length;i++){
    					        html+="<li class='aui-list-item'><input class='aui-list-item-title' onclick='selectMusic"+i+"()' id='"+ret[i].music_id+ "'type='button' value='"+ret[i].name+" --"+ret[i].singer+"'></li>";
    					    //html+="<div>第"+i+"行div</div>";
    				      }
    				      document.getElementById('aui-list aui-list-noborder').innerHTML=html;
                  //alert(ret[0].name)

                  //alert(JSON.stringify( ret ))
               }else{
                  alert("抱歉，无搜索结果");
               }
             });
            }
          });
        }
        //window.onload = search;
        //根据歌手名搜索
        function search1(){
           var value = name_or_singer;
           var query = api.require('query');
           var model = api.require('model');
              model.config({
               appKey: '075A132B-2B11-505D-F01E-FA8B51604C1B',
               appId: 'A6036872544676',
               host: 'https://d.apicloud.com'
              });
              query.createQuery(function(ret,err){
            if(ret && ret.qid){
             //console.log(ret.qid)
             query.whereLike({
               qid:ret.qid,
               value:value,
               column:'singer'
             });
             model.findAll({
              class: 'music',
              qid: ret.qid
             },function(ret,err){
               if(ret){
                 alert(JSON.stringify( ret ))
                 //ret.length  搜索结果条数
                 alert(ret.length);
                 var html="";
                 var div = document.getElementById('aui-list-item-inner');
                 for(var n = 0; n<ret.length;n++)
                   {
                       div.innerHTML+="<li class='aui-list-item'><input class='aui-list-item-title' id='455432' type='button' value='Menuet D major --Wolfgang Amadeu'></li>";
                       //html += "<li class=''aui-list-item'><script type='text/javascript'> function selectMusic{netplay()}<input class='aui-list-item-title' id='455432' type='button' value='Menuet D major --Wolfgang Amadeu'></li>";
                   }
                   //var div = document.getElementById("aui-list-item-inner").innerHTML=html;
                 //alert(ret[0].name)

                 //alert(JSON.stringify( ret ))
               }else{
                  alert("抱歉无搜索结果");
               }
             });
            }
          });
        }
        //window.onload = search1;

        function getCurrentPlayer() {
            demo.getCurrentPlayer(function(ret, err) {
                alert("getCurrentPlayer|" + JSON.stringify(ret));
            });
        }

        function selectMusic0() {
            netplay();
            demo.selectMusic({
                other:1
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic1() {
            netplay();
            demo.selectMusic({
                other:2
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic2() {
            netplay();
            demo.selectMusic({
                other:3
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic3() {
            netplay();
            demo.selectMusic({
                other:4
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic4() {
            netplay();
            demo.selectMusic({
                other:5
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic5() {
            netplay();
            demo.selectMusic({
                other:6
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic6() {
            netplay();
            demo.selectMusic({
                other:7
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic7() {
            netplay();
            demo.selectMusic({
                other:8
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic8() {
            netplay();
            demo.selectMusic({
                other:9
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }

        function selectMusic9() {
            netplay();
            demo.selectMusic({
                other:10
            }, function(ret, err) {
                alert("selectMusic|" + JSON.stringify(ret));
            });
        }
        //url = "http://music.163.com/song/media/outer/url?id="+ret[n].music_id+".mp3"
        //var musics={'name':'ret[n]name','filename':'url','singer':'ret[n].singer','icon':'http://p1.music.126.net/6F8-Rp8MUvxzrpTjxJiA7A==/109951164764756625.jpg?param=130y130','other':n,fenxiangSum: 43,downmusicSum: 12,pinglunSum: 45,background: "http://7xwc0t.com1.z0.glb.clouddn.com/apicloud/3a3d926564ab4c5b2292744d5ffb0ec6.jpg"}

        function netplay() {
            var url = "http://music.163.com/song/media/outer/url?id=1426883824.mp3"
            demo.playMusic({
                musics: [{
                    name: "朋友请听好(易烊千玺版)",
                    filename: url,
                    singer: "易烊千玺",
                    icon: "http://p1.music.126.net/6F8-Rp8MUvxzrpTjxJiA7A==/109951164764756625.jpg?param=130y130",
                    other: 1,
                    fenxiangSum: 43,
                    downmusicSum: 12,
                    pinglunSum: 45,
                    background: "http://7xwc0t.com1.z0.glb.clouddn.com/apicloud/3a3d926564ab4c5b2292744d5ffb0ec6.jpg"
                }, {
                    name: "我们 (Live)",
                    filename: "http://music.163.com/song/media/outer/url?id=1428605192.mp3",
                    singer: "华晨宇",
                    icon: "http://p2.music.126.net/8CBeG0BF2C0dPiA1FDflGQ==/109951164773621591.jpg?param=130y130",
                    other: 2,
                    fenxiangSum: 43,
                    downmusicSum: 12,
                    pinglunSum: 45,
                    background: "http://7xwc0t.com1.z0.glb.clouddn.com/apicloud/3a3d926564ab4c5b2292744d5ffb0ec6.jpg"
                }, {
                    name: "新世界 (Live)",
                    filename: "http://music.163.com/song/media/outer/url?id=1434057772.mp3",
                    singer: "华晨宇",
                    icon: "http://p1.music.126.net/P11c_X9qdAMT7yXYIMahQw==/109951164840856331.jpg?param=130y130",
                    other: 3,
                    fenxiangSum: 43,
                    downmusicSum: 12,
                    pinglunSum: 45,
                    background: "http://7xwc0t.com1.z0.glb.clouddn.com/apicloud/3a3d926564ab4c5b2292744d5ffb0ec6.jpg"
                }],
                ttf: "widget://res/UKIJTor.ttf",
                downmusicBtn: false,
                fenxiangBtn: true,
                pinglunBtn: true,
                nameTextSize: 20,
                singerTextSize: 16,
                isShowUi: false
            }, function(ret, err) {});
        }

        function show() {
            demo.showUI();
        }

        function close() {
            demo.closeUI();
        }

        function stop() {
            demo.stopMusic();
        }

        function musicPrevious() {
            netplay();
            demo.musicPrevious();
        }


        function musicPlayPause() {
            netplay();
            demo.musicPlayPause();
        }

        function musicNext() {
            netplay();
            demo.musicNext();
        }

        function apiready() {
            demo = api.require('uimusic');
            demo.addEventListener({
                name: "closeui"
            }, function(ret, err) {
                alert("closeui>>addEventListener|" + JSON.stringify(ret));
            });
            demo.addEventListener({
                name: "pinglun"
            }, function(ret, err) {
                alert("pinglun>>addEventListener|" + JSON.stringify(ret));
            });
            demo.addEventListener({
                name: "fenxiang"
            }, function(ret, err) {
                alert("fenxiang>>addEventListener|" + JSON.stringify(ret));
            });
            demo.addEventListener({
                name: "downmusic"
            }, function(ret, err) {
                alert("downmusic>>addEventListener|" + JSON.stringify(ret));
            });

            demo.addEventListener({
                name: "sharetop"
            }, function(ret, err) {
                alert("sharetop>>addEventListener|" + JSON.stringify(ret));
            });
        }
    </script>
</body>
</html>
